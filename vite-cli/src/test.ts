/**
 * æµ‹è¯•è„šæœ¬
 * åŒæ—¶ç”Ÿæˆ Vue å’Œ React æµ‹è¯•é¡¹ç›®ï¼Œå¯ç”¨æ‰€æœ‰åŠŸèƒ½
 */

import type { ProjectConfig } from './types/index.ts'
import * as process from 'node:process'
import { generateProject } from './generators/project'

/**
 * Vue æµ‹è¯•é…ç½®ï¼ˆå¯ç”¨æ‰€æœ‰åŠŸèƒ½ï¼‰
 */
const vueTestConfig: ProjectConfig = {
  projectName: 'vue',
  description: 'Vue test project generated by vite-cli',
  author: 'vite-cli',
  framework: 'vue',
  uiLibrary: 'element-plus',
  routeMode: 'file-system',
  i18n: true,
  qiankun: true,
  sentry: true,
  packageManager: 'pnpm',
  targetDir: `${process.cwd().replace(/vite-cli$/, '')}vite-cli-test/vue`,
}

/**
 * React æµ‹è¯•é…ç½®ï¼ˆå¯ç”¨æ‰€æœ‰åŠŸèƒ½ï¼‰
 */
const reactTestConfig: ProjectConfig = {
  projectName: 'react',
  description: 'React test project generated by vite-cli',
  author: 'vite-cli',
  framework: 'react',
  uiLibrary: 'ant-design',
  routeMode: 'file-system',
  i18n: true,
  qiankun: true,
  sentry: true,
  packageManager: 'pnpm',
  targetDir: `${process.cwd().replace(/vite-cli$/, '')}vite-cli-test/react`,
}

/**
 * è¿è¡Œæµ‹è¯•
 */
async function runTest() {
  try {
    console.log('ğŸš€ Starting test project generation...\n')

    // ç”Ÿæˆ Vue é¡¹ç›®
    console.log('ğŸ“¦ Generating Vue project...')
    console.log('Configuration:')
    console.log(`  Framework: ${vueTestConfig.framework}`)
    console.log(`  UI Library: ${vueTestConfig.uiLibrary}`)
    console.log(`  Route Mode: ${vueTestConfig.routeMode}`)
    console.log(`  i18n: ${vueTestConfig.i18n}`)
    console.log(`  Qiankun: ${vueTestConfig.qiankun}`)
    console.log(`  Sentry: ${vueTestConfig.sentry}`)
    console.log(`  Target: ${vueTestConfig.targetDir}\n`)

    await generateProject(vueTestConfig)
    console.log('âœ… Vue project generated successfully!\n')

    // ç”Ÿæˆ React é¡¹ç›®
    console.log('ğŸ“¦ Generating React project...')
    console.log('Configuration:')
    console.log(`  Framework: ${reactTestConfig.framework}`)
    console.log(`  UI Library: ${reactTestConfig.uiLibrary}`)
    console.log(`  Route Mode: ${reactTestConfig.routeMode}`)
    console.log(`  i18n: ${reactTestConfig.i18n}`)
    console.log(`  Qiankun: ${reactTestConfig.qiankun}`)
    console.log(`  Sentry: ${reactTestConfig.sentry}`)
    console.log(`  Target: ${reactTestConfig.targetDir}\n`)

    await generateProject(reactTestConfig)
    console.log('âœ… React project generated successfully!\n')

    console.log('ğŸ‰ All test projects generated successfully!')
    console.log(`\nğŸ“ Vue project: ${vueTestConfig.targetDir}`)
    console.log(`ğŸ“ React project: ${reactTestConfig.targetDir}`)
  }
  catch (error) {
    console.error('\nâŒ Error:', error)
    process.exit(1)
  }
}

runTest()
